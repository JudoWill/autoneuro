---

title: AutoNeuro


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "09_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 09_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will be easiest with an example test.
The BVMT-R is a useful example.
There are multiple measurements for the test Immediate Recall, Delayed Recall, and Recognition.
The values represent the number of cards remembered after different lengths of time.
Here's an example dataset.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bvmt_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/testing/bvmt.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;na&#39;</span><span class="p">])</span>
<span class="n">bvmt_demo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/testing/bvmt_demo.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;na&#39;</span><span class="p">])</span>
<span class="n">bvmt_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">bvmt_data</span><span class="p">,</span> <span class="n">bvmt_demo</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bvmt_all</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BVMTform</th>
      <th>BVMTtrial1</th>
      <th>BVMTtrial2</th>
      <th>BVMTtrial3</th>
      <th>BVMTimmed</th>
      <th>BVMTdelay</th>
      <th>BVMTretention</th>
      <th>BVMThits</th>
      <th>BVMTfalsepos</th>
      <th>BVMTrecog</th>
      <th>BVMTcopy</th>
      <th>Age</th>
      <th>Sex</th>
      <th>Race</th>
      <th>Race_specify</th>
      <th>Education</th>
      <th>EngFluency</th>
      <th>SpanFluency</th>
      <th>MMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>10.0</td>
      <td>4.0</td>
      <td>100.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>12.0</td>
      <td>47</td>
      <td>1</td>
      <td>2</td>
      <td>NaN</td>
      <td>10</td>
      <td>3</td>
      <td>0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>15.0</td>
      <td>6.0</td>
      <td>86.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>12.0</td>
      <td>57</td>
      <td>1</td>
      <td>2</td>
      <td>NaN</td>
      <td>9</td>
      <td>3</td>
      <td>0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>50.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>12.0</td>
      <td>64</td>
      <td>1</td>
      <td>2</td>
      <td>NaN</td>
      <td>16</td>
      <td>3</td>
      <td>0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>16.0</td>
      <td>7.0</td>
      <td>100.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>45</td>
      <td>2</td>
      <td>2</td>
      <td>NaN</td>
      <td>10</td>
      <td>3</td>
      <td>0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>12.0</td>
      <td>3.0</td>
      <td>50.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>73</td>
      <td>1</td>
      <td>2</td>
      <td>NaN</td>
      <td>10</td>
      <td>3</td>
      <td>0</td>
      <td>29.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our goal is to transform this data utilizing a collection of known normalization schemes.
We will adapt the sklearn API to perform these tasks.
This will allow us to use the vast array of other tools in the sklearn ecosystem.</p>
<p>Let's start by using a lookup table style normalization scheme.
This lookup table provides the mean and std of a "healthy" population on the same test.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bvmt_norm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/testing/bvmtr_extract.csv&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">bvmt_norm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;MaxAge&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Expected&#39;</span><span class="p">)</span>
<span class="n">bvmt_all</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;BVMTimmed&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Obs&#39;</span><span class="p">,</span>
              <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Expected Immediate Recall&#39;</span><span class="p">)</span>
<span class="n">bvmt_norm</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MinAge</th>
      <th>MaxAge</th>
      <th>Total</th>
      <th>Total-STD</th>
      <th>Learn</th>
      <th>Learn-STD</th>
      <th>DR</th>
      <th>DR-STD</th>
      <th>ret</th>
      <th>ret-STD</th>
      <th>Disc</th>
      <th>Disc-STD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18</td>
      <td>21</td>
      <td>28.74</td>
      <td>4.32</td>
      <td>3.63</td>
      <td>1.67</td>
      <td>10.79</td>
      <td>1.37</td>
      <td>95.34</td>
      <td>6.60</td>
      <td>5.91</td>
      <td>0.31</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>23</td>
      <td>28.44</td>
      <td>4.38</td>
      <td>3.64</td>
      <td>1.68</td>
      <td>10.68</td>
      <td>1.41</td>
      <td>94.93</td>
      <td>7.26</td>
      <td>5.92</td>
      <td>0.26</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24</td>
      <td>25</td>
      <td>27.83</td>
      <td>4.48</td>
      <td>3.65</td>
      <td>1.69</td>
      <td>10.46</td>
      <td>1.48</td>
      <td>95.08</td>
      <td>8.04</td>
      <td>5.89</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>29</td>
      <td>27.52</td>
      <td>4.54</td>
      <td>3.66</td>
      <td>1.70</td>
      <td>10.35</td>
      <td>1.52</td>
      <td>96.67</td>
      <td>6.31</td>
      <td>5.97</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>30</td>
      <td>33</td>
      <td>26.92</td>
      <td>4.64</td>
      <td>3.67</td>
      <td>1.71</td>
      <td>10.13</td>
      <td>1.60</td>
      <td>96.20</td>
      <td>4.74</td>
      <td>5.97</td>
      <td>0.15</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAX4AAAEGCAYAAABiq/5QAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8vihELAAAACXBIWXMAAAsTAAALEwEAmpwYAAAqTklEQVR4nO3deXxV9Z3/8dcnISEr2RGUQBAJWmQLSF1YVKp1rEOrtW7jjNpOcaoz2hl1inU61jr+6jxap+OMox2rTrXjMrXWaq1VfBQVrAsF3NgXWRIFCSQQCEJC8vn9cW4uQSFckpzc7f18PPK4uecu5/Nl+Zxzvuf7/X7M3RERkfSREe8ARESkbynxi4ikGSV+EZE0o8QvIpJmlPhFRNJMv3gHEIvy8nKvqqqKdxgiIkll0aJFW9294tPbkyLxV1VVsXDhwniHISKSVMxsw8G2q6tHRCTNKPGLiKQZJX4RkTSTFH38IpKaWltbqaurY8+ePfEOJanl5OQwZMgQsrKyYnq/Er+IxE1dXR2FhYVUVVVhZvEOJym5O9u2baOuro7hw4fH9Bl19YhI3OzZs4eysjIl/R4wM8rKyo7oqkmJX0TiSkm/5470zzClu3peXrGFtfW7mFZdwciBBfoHJiJCqif+lVt45I0N8LvlDBqQw7TqcqaOrGDKceWU5GfHOzwRSQCZmZmMGTMm+vySSy5h9uzZoe5z+/btPPbYY1xzzTVH9Lnvf//7FBQUcOONN/Zo/ymd+H/w5RO5evoI5q+qZ97qel5YsplfLqzDDMYOKWb6yHKmVVcwvrKYfpnq9RJJR7m5ubzzzjt9us/t27dz7733HnHi7y0pn+2OKc7lkslDufcvJrL4e2fx1LdO5bozR5JhcM/La7jwp28w4faXuObRRbxftyPe4YpIAtixYwejRo1i5cqVAFx66aX87Gc/A6CgoIAbbriBmpoaZsyYQX19PQBr167lnHPOYeLEiUydOpUVK1YA8PHHH3P++eczbtw4xo0bx+uvv87s2bNZu3Yt48eP56abbgLgRz/6ESeddBJjx47l1ltvjcZyxx13MGrUKL7whS9E4+mplD7j/7R+mRlMHFbCxGEl/P1Z1Wzf3cIf12xj3qp65izbzO+XbOaCCUO46YujGFSUE+9wRdLKbb9dyrKPmnr1Oz939ABu/fPRXb7nk08+Yfz48dHnN998MxdffDH33HMPV155Jddffz2NjY1885vfBKC5uZmamhruuusufvCDH3Dbbbdxzz33MGvWLH76058ycuRI3nrrLa655hrmzp3Lddddx/Tp03n66adpa2tj165d3HnnnSxZsiR6pTFnzhxWr17NggULcHdmzpzJvHnzyM/P54knnuDtt99m37591NTUMHHixB7/uaRV4v+04rxsvjR2MF8aO5hb9pzAf728hv95bT3Pv7+JWdOO5erpx5KXndZ/RCIp71BdPWeddRZPPvkk1157Le+++250e0ZGBhdffDEAl19+ORdccAG7du3i9ddf52tf+1r0fXv37gVg7ty5PPLII0BwP6GoqIjGxsYD9jVnzhzmzJnDhAkTANi1axerV69m586dnH/++eTl5QEwc+bMXmmzslrEgJwsbv6zE7j888O484UV3P2H1Tzxp43c9MXjuWDCMWRkaESQSJgOd2be19rb21m+fDm5ubk0NDQwZMiQg77PzGhvb6e4uLjb9wrcnZtvvpmrr776gO3//u//HspoxJTv4z9SlaV5/NdlNfzqb05h0IAcbnzyXWb+12u8+cG2eIcmIn3oJz/5CSeccAKPP/44X//612ltbQWCA8KvfvUrAB577DGmTJnCgAEDGD58OE8++SQQJPKOq4QZM2Zw3333AdDW1kZTUxOFhYXs3Lkzuq8vfvGLPPTQQ+zatQuADz/8kC1btjBt2jSefvppPvnkE3bu3Mlvf/vbXmmbEv8hTKoq5elrTuPuS8bTsKuFS+5/k6t/sZD1W5vjHZqI9KKOPv6On9mzZ7Nq1SoeeOAB7rrrLqZOncq0adP4l3/5FwDy8/NZunQpEydOZO7cufzzP/8zAI8++igPPvgg48aNY/To0TzzzDMA3H333bz88suMGTOGiRMnsnTpUsrKyjjttNM48cQTuemmmzj77LO57LLLOOWUUxgzZgwXXnghO3fupKamhosvvpjx48fz1a9+lalTp/ZKm83de+WLwjRp0iSPZyGWT1raePC1D7j3lbW0trUzaVgpVeV5VJXlU1WeT1VZPsPK8sjJyoxbjCLJaPny5ZxwwgnxDuOIFBQURM/ME8nB/izNbJG7T/r0e9XHH4Pc7Ez+9syRXDSpkntfWct7ddt5cenHNDS3HPC+o4tyGBY5GAwvz2NYWT7Dy/MZWqqDgogkDiX+IzBwQA7f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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As expected, the average expected number of cards recalled goes down with age (blue line).
The plotted points mostly fall below this line, indicating that they are performing worse compared to age-matched controls.
Let's use a transformer to correct for these problems.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will need to re-arrange the normalization table into a more suitable format.
This uses __ to indicate operations based on a currently limited language.
These need to map to the same columns as the input data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MinAge&#39;</span><span class="p">:</span><span class="s1">&#39;Age__gte&#39;</span><span class="p">,</span>
           <span class="s1">&#39;MaxAge&#39;</span><span class="p">:</span><span class="s1">&#39;Age__lte&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Total&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTimmed__mean&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Total-STD&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTimmed__std&#39;</span><span class="p">,</span>
           <span class="p">}</span>
<span class="n">immed_extracted_norm</span> <span class="o">=</span> <span class="n">bvmt_norm</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">)[</span><span class="n">mapping</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">immed_extracted_norm</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age__gte</th>
      <th>Age__lte</th>
      <th>BVMTimmed__mean</th>
      <th>BVMTimmed__std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18</td>
      <td>21</td>
      <td>28.74</td>
      <td>4.32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>23</td>
      <td>28.44</td>
      <td>4.38</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24</td>
      <td>25</td>
      <td>27.83</td>
      <td>4.48</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>29</td>
      <td>27.52</td>
      <td>4.54</td>
    </tr>
    <tr>
      <th>4</th>
      <td>30</td>
      <td>33</td>
      <td>26.92</td>
      <td>4.64</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">transform_immed</span> <span class="o">=</span> <span class="n">LookupNormalTransform</span><span class="p">(</span><span class="n">immed_extracted_norm</span><span class="p">,</span>
                                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;BVMTimmed&#39;</span><span class="p">)</span>

<span class="c1"># You can extract the index of matched samples</span>
<span class="n">hits</span> <span class="o">=</span> <span class="n">transform_immed</span><span class="o">.</span><span class="n">match_samples</span><span class="p">(</span><span class="n">bvmt_all</span><span class="p">)</span>

<span class="c1"># Or transform into normalized Z-scores directly</span>
<span class="n">z_scores_immed</span> <span class="o">=</span> <span class="n">transform_immed</span><span class="o">.</span><span class="n">normalize_samples</span><span class="p">(</span><span class="n">bvmt_all</span><span class="p">)</span>
<span class="n">z_scores_immed</span> <span class="o">=</span> <span class="n">transform_immed</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">bvmt_all</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MinAge&#39;</span><span class="p">:</span><span class="s1">&#39;Age__gte&#39;</span><span class="p">,</span>
           <span class="s1">&#39;MaxAge&#39;</span><span class="p">:</span><span class="s1">&#39;Age__lte&#39;</span><span class="p">,</span>
           <span class="s1">&#39;DR&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTdelay__mean&#39;</span><span class="p">,</span>
           <span class="s1">&#39;DR-STD&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTdelay__std&#39;</span><span class="p">,</span>
           <span class="p">}</span>
<span class="n">dr_extracted_norm</span> <span class="o">=</span> <span class="n">bvmt_norm</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">)[</span><span class="n">mapping</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

<span class="n">transform_dr</span> <span class="o">=</span> <span class="n">LookupNormalTransform</span><span class="p">(</span><span class="n">dr_extracted_norm</span><span class="p">,</span>
                                     <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;BVMTdelay&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Cool, but I don't want to have to build each one one at a time.
So, there are some utility functions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_merged_transformers" class="doc_header"><code>build_merged_transformers</code><a href="https://github.com/judowill/autoneuro/tree/main/autoneuro/core.py#L209" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_merged_transformers</code>(<strong><code>df</code></strong>, <strong><code>groupings</code></strong>, <strong><code>universal_cols</code></strong>=<em><code>None</code></em>, <strong><code>prefix</code></strong>=<em><code>''</code></em>, <strong><code>transform_class</code></strong>=<em><code>LookupNormalTransform</code></em>, <strong><code>skip_final</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Build a set of merged transformers.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>df : pd.DataFrame
groupings : dict
universal_cols : list
prefix : str
transform_class : cls
skip_final : bool
  Useful if chaining multiple calls together before constructing the transformer.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>ColumnTransformer</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># BVMT_hit BVMT_FP</span>

<span class="n">bvmt_formatted</span> <span class="o">=</span> <span class="n">bvmt_norm</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;MinAge&#39;</span><span class="p">:</span><span class="s1">&#39;Age__gte&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;MaxAge&#39;</span><span class="p">:</span><span class="s1">&#39;Age__lte&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;DR&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTdelay__mean&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;DR-STD&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTdelay__std&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Total&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTimmed__mean&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Total-STD&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTimmed__std&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Disc&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTrecog__mean&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Disc-STD&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTrecog__std&#39;</span><span class="p">})</span>



<span class="n">bvmt_groupings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;BVMTimmed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BVMTimmed__mean&#39;</span><span class="p">,</span> <span class="s1">&#39;BVMTimmed__std&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;BVMTdelay&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BVMTdelay__mean&#39;</span><span class="p">,</span> <span class="s1">&#39;BVMTdelay__std&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;BVMTrecog&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BVMTrecog__mean&#39;</span><span class="p">,</span> <span class="s1">&#39;BVMTrecog__std&#39;</span><span class="p">]</span>
                  <span class="p">}</span>

<span class="n">bvmt_transforms</span> <span class="o">=</span> <span class="n">build_merged_transformers</span><span class="p">(</span><span class="n">bvmt_formatted</span><span class="p">,</span> <span class="n">bvmt_groupings</span><span class="p">,</span>
                                           <span class="n">universal_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Age__gte&#39;</span><span class="p">,</span> <span class="s1">&#39;Age__lte&#39;</span><span class="p">],</span>
                                           <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;lookup_&#39;</span><span class="p">,</span> <span class="n">transform_class</span> <span class="o">=</span> <span class="n">LookupNormalTransform</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">bvmt_transforms</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">bvmt_all</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>BVMTimmed     BVMTimmed
0         NaN
1         NaN
2         NaN
3   -0.679035
4   -0.493506
5   -0.998106
6   -1.133205
7    0.172727
8   -2.856016
9   -1.566288
10  -2.554545
11  -1.832661
12  -1.546410
BVMTdelay     BVMTdelay
0         NaN
1         NaN
2         NaN
3   -1.215962
4   -1.215962
5   -0.882927
6         NaN
7   -0.622727
8   -2.763158
9   -1.370732
10  -2.895455
11  -1.349727
12  -2.088983
BVMTrecog     BVMTrecog
0         NaN
1         NaN
2         NaN
3   -1.954545
4    0.318182
5   -2.948276
6         NaN
7    0.166667
8   -8.142857
9   -2.948276
10  -4.000000
11   0.291667
12  -0.703297
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_from_yaml" class="doc_header"><code>build_from_yaml</code><a href="https://github.com/judowill/autoneuro/tree/main/autoneuro/core.py#L241" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_from_yaml</code>(<strong><code>path</code></strong>, <strong><code>_nested</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ex_path</span> <span class="o">=</span> <span class="s1">&#39;data/norms/from_kate/BVMTR/description.yaml&#39;</span>
<span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">build_from_yaml</span><span class="p">(</span><span class="n">ex_path</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">bvmt_all</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>BVMTimmed BVMTimmed   -1.348705
dtype: float64
BVMTdelay BVMTdelay   -1.600626
dtype: float64
BVMTrecog BVMTrecog   -2.213415
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That worked great.
However, some norms are regression based.
Utilizing these norms requires a 2 step process.
First, raw values need to be scaled into the units used by the researcher.
Then, the scaled values are used in a regression equation along with demographic variables.</p>
<p>We'll use the BVMTdelay for Caucasians from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3154384/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3154384/</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scale_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/testing/heaton_bvtm_scales.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
<span class="n">scale_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>scaled</th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>2</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>0</th>
      <td>14</td>
      <td>12</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scale_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">scale_data</span><span class="p">[</span><span class="s1">&#39;scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                      <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IntervalIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">scale_data</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                                           <span class="n">scale_data</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                                           <span class="n">closed</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">))</span>


<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;raw&#39;</span><span class="p">:</span><span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;BVMTdelay&#39;</span><span class="p">],</span>
              <span class="s1">&#39;scaled&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;BVMTdelay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scale_ser</span><span class="o">.</span><span class="n">get</span><span class="p">)})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>raw</th>
      <th>scaled</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>7.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we have to deal with the regression equation.</p>
<p>((scaled-(0.2267<em>(Education-13.86) + (-0.1262)</em>(Age-40.63) + 0.8593<em>heaton_gender + 7.691))/2.5197)</em>10 + 50
Heaton_gender is 1 for female and 0 for male.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Slightly Edited for z-scaling</span>
<span class="n">eqn</span> <span class="o">=</span> <span class="s2">&quot;(scaled-(0.2267*(Education-13.86) + (-0.1262)*(Age-40.63) + 0.8593*heaton_gender + 7.691))/2.5197&quot;</span>

<span class="n">cal_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;scaled&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;BVMTdelay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scale_ser</span><span class="o">.</span><span class="n">get</span><span class="p">),</span>
                         <span class="s1">&#39;Education&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">],</span>
                         <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span>
                         <span class="s1">&#39;heaton_gender&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                                                   <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">})})</span>

<span class="n">normed_data</span> <span class="o">=</span> <span class="n">ne</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="n">local_dict</span><span class="o">=</span><span class="n">cal_data</span><span class="p">)</span>
<span class="n">normed_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([        nan,         nan,         nan,  0.16968528, -0.19019883,
        0.0861039 ,         nan,  0.61664325, -0.79852522,  0.18917173,
       -1.28064611, -0.44598325,  0.10682065])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sweet, Z-scaled data!
But not everyone is Caucasian, we need a way to adjust the scaling based on other factors.
We'll use another subclass of the sklearn API to make our lives easier again.</p>
<p>First, we'll make a node that encapsulates the logic renaming columns and syncing coding that can be shared across implementations.
Then we'll need another node that matches filters and calculating the values.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EncodingTransform" class="doc_header"><code>class</code> <code>EncodingTransform</code><a href="https://github.com/judowill/autoneuro/tree/main/autoneuro/core.py#L259" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EncodingTransform</code>(<strong><code>replacements</code></strong>=<em><code>None</code></em>, <strong><code>renames</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoder_transform</span> <span class="o">=</span> <span class="n">EncodingTransform</span><span class="p">(</span><span class="n">replacements</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Sex&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                                              <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                                                      <span class="s1">&#39;Race&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;AA&#39;</span><span class="p">,</span>
                                                               <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;White&#39;</span><span class="p">}},</span>
                                      <span class="n">renames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Sex&#39;</span><span class="p">:</span> <span class="s1">&#39;heaton_gender&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;Race&#39;</span><span class="p">:</span> <span class="s1">&#39;RaceCat&#39;</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ScaledRegressionNode" class="doc_header"><code>class</code> <code>ScaledRegressionNode</code><a href="https://github.com/judowill/autoneuro/tree/main/autoneuro/core.py#L324" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ScaledRegressionNode</code>(<strong><code>field</code></strong>, <strong><code>scale_col</code></strong>, <strong><code>scales</code></strong>, <strong><code>flt</code></strong>, <strong><code>eqn</code></strong>, <strong><code>needed_cols</code></strong>, <strong><code>result</code></strong>=<em><code>'zscale'</code></em>, <strong><code>transform</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eqn</span> <span class="o">=</span> <span class="s2">&quot;(scaled-(0.2267*(Education-13.86) + (-0.1262)*(Age-40.63) + 0.8593*heaton_gender + 7.691))/2.5197&quot;</span>
<span class="n">flt</span> <span class="o">=</span> <span class="s1">&#39;(RaceCat == &quot;AA&quot;) &amp; ((Age &gt;= 18) &amp; (Age &lt;= 66))&#39;</span>

<span class="n">smaller_data</span> <span class="o">=</span> <span class="n">bvmt_all</span>


<span class="n">cal_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;scaled&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;BVMTdelay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scale_ser</span><span class="o">.</span><span class="n">get</span><span class="p">),</span>
                         <span class="s1">&#39;Education&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">],</span>
                         <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span>
                         <span class="s1">&#39;heaton_gender&#39;</span><span class="p">:</span> <span class="n">bvmt_all</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">()})</span>


<span class="n">node</span> <span class="o">=</span> <span class="n">ScaledRegressionNode</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;BVMTdelay&#39;</span><span class="p">,</span> <span class="n">scale_ser</span><span class="p">,</span> <span class="n">flt</span><span class="p">,</span> <span class="n">eqn</span><span class="p">,</span>
                            <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;BVMTdelay&#39;</span><span class="p">,</span> <span class="s1">&#39;Race&#39;</span><span class="p">],</span>
                            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;zscale&#39;</span><span class="p">,</span>
                            <span class="n">transform</span> <span class="o">=</span> <span class="n">encoder_transform</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ScaledRegressionTransform" class="doc_header"><code>class</code> <code>ScaledRegressionTransform</code><a href="https://github.com/judowill/autoneuro/tree/main/autoneuro/core.py#L423" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ScaledRegressionTransform</code>(<strong><code>name</code></strong>=<em><code>''</code></em>, <strong><code>norm_nodes</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">heaton_transform</span> <span class="o">=</span> <span class="n">EncodingTransform</span><span class="p">(</span><span class="n">replacements</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Sex&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                                              <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                                                      <span class="s1">&#39;Race&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;AA&#39;</span><span class="p">,</span>
                                                               <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;White&#39;</span><span class="p">}},</span>
                                      <span class="n">renames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Sex&#39;</span><span class="p">:</span> <span class="s1">&#39;heaton_gender&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;Race&#39;</span><span class="p">:</span> <span class="s1">&#39;RaceCat&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;BVMTimmed&#39;</span><span class="p">:</span> <span class="s1">&#39;BVMTtotalrecal&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;HVLT.total&#39;</span><span class="p">:</span> <span class="s1">&#39;HVLTtotalrecal&#39;</span>
                                                  <span class="p">})</span>




<span class="n">heaton_normer</span> <span class="o">=</span> <span class="n">ScaledRegressionTransform</span><span class="o">.</span><span class="n">from_yaml</span><span class="p">([</span><span class="s1">&#39;data/norms/heaton/heaton_AA_BVMTdelay.yaml&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;data/norms/heaton/heaton_AA_BVMTtotalrecall.yaml&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;data/norms/heaton/heaton_White_BVMTdelay.yaml&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;data/norms/heaton/heaton_White_BVMTtotalrecall.yaml&#39;</span><span class="p">,</span>
                                                     <span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">heaton_transform</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">heaton_res</span> <span class="o">=</span> <span class="n">heaton_normer</span><span class="o">.</span><span class="n">normalize_samples</span><span class="p">(</span><span class="n">bvmt_all</span><span class="p">)</span>
<span class="n">heaton_res</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BVMTdelay</th>
      <th>BVMTtotalrecal</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.169685</td>
      <td>0.725010</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.190199</td>
      <td>0.283938</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

